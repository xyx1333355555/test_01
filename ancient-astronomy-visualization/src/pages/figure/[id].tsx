import { useRouter } from 'next/router';
import { useEffect, useState, useRef } from 'react';
import Head from 'next/head';
import Link from 'next/link';
import { motion } from 'framer-motion';
import * as THREE from 'three';
import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';
import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';
import { timelineData } from '@/data/timelineData';
import Header from '@/components/layout/Header';
import Footer from '@/components/layout/Footer';

// 从timelineData中提取keyFigures的类型
type KeyFigure = {
  name: string;
  title?: string;
  contribution: string;
};

// 定义历史人物数据类型
type HistoricalFigure = {
  id: string;
  name: string;
  title?: string;
  dynasty: string;
  dynastyId: string;
  birthDeath?: string;
  contribution: string;
  achievements: string[];
  biography: string;
  impact: string;
  modelPath?: string; // 3D模型路径
};

// 从所有朝代数据中提取人物信息
const getAllHistoricalFigures = (): HistoricalFigure[] => {
  const figures: HistoricalFigure[] = [];
  
  timelineData.forEach(dynasty => {
    dynasty.keyFigures.forEach((figure: KeyFigure) => {
      // 为后羿添加特殊详细信息
      if (figure.name === '后羿') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: figure.title || '传说中的英雄天射手',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '传说中生活于尧帝和帝喾时期（约公元前2200年）',
          contribution: figure.contribution,
          achievements: [
            '射日神话：相传射下九个太阳，拯救世界于干旱灾难',
            '天文观测：被视为最早的天象观察者之一，能通过观星辨别季节',
            '日食解释：后羿射日神话被认为是对日食现象的早期解释',
            '星象预测：传说能根据星象变化预测天气和农业收成'
          ],
          biography: '后羿是中国上古神话中的著名英雄，被誉为"神射手"。相传他生活在尧帝时期，当时天空中出现了十个太阳，导致大地干旱，庄稼枯死，人民生活困苦。后羿受命射下九个太阳，只留下一个，拯救了世界。除射日外，后羿还斩杀了猰貐、凿齿、九婴、大风、封豨等妖怪，为民除害。在一些传说中，后羿后来获得了不死药，但被其妻嫦娥偷吃，嫦娥因此飞到月亮上成为月神。后羿的故事在中国文化中广为流传，成为勇气和自我牺牲的象征。',
          impact: '后羿射日的神话对中国古代天文学产生了深远影响。这一神话反映了古人对天文现象的观察和解释，特别是对日食和太阳活动的认知。在古代，人们通过这样的神话来解释自然现象，为天文学的发展奠定了文化基础。后羿还被视为古代观星术的创始人之一，传说他能根据星象变化预测天气和季节更替，为农业生产提供指导。这种将天文观测与农业生产相结合的思想，成为中国古代天文学的重要特点。后羿的故事也体现了中国古代对天象的敬畏和对自然规律的探索精神，影响了后世的天文观测和历法制定。',
          modelPath: '/models/figures/houyi.glb'
        });
      } else if (figure.name === '仪狄') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '夏朝天文官',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '传说中生活于夏朝初期（约公元前2070年-前1600年）',
          contribution: figure.contribution || '相传为夏朝天文官，负责观测天象和制定历法，是中国最早的天文历法专家之一。仪狄精通天文观测，能够根据星象变化预测季节更替，为农业生产提供指导。他还参与制定了夏朝的历法系统，将天文观测与农业生产紧密结合，奠定了中国古代天文历法的基础。',
          achievements: [
            '历法制定：参与创立夏朝历法，将天文观测与农时结合',
            '星象观测：系统观测星象变化，为农业生产提供指导',
            '节气确立：根据太阳运行规律，确立了早期的节气系统',
            '天文仪器：相传发明或改进了早期的观测工具，如土圭等'
          ],
          biography: '仪狄是中国上古时期传说中的重要人物，被记载为夏朝初期的天文官和酿酒师。相传他生活在大禹时期，是夏朝宫廷中的重要官员。作为天文官，仪狄负责观测天象、制定历法，为农业生产提供指导。他通过观察星象变化，能够预测季节更替和天气变化，帮助人们安排农事活动。在《史记》和《吕氏春秋》等古籍中，仪狄也被记载为最早的酿酒师，相传他发明了甜酒，并将酿酒技术献给大禹。仪狄的天文观测工作与酿酒技术都与农业生产密切相关，反映了古代中国天文学与农业生产的紧密联系。虽然关于仪狄的记载多为传说，但他在中国古代天文学和文化史上的地位不容忽视。',
          impact: '仪狄作为传说中的夏朝天文官，对中国古代天文学的早期发展产生了重要影响。他参与制定的历法系统，将天文观测与农业生产紧密结合，奠定了中国古代天文历法的基础。这种将天文与农业结合的思想，成为中国古代天文学的重要特点，影响了后世数千年的天文历法发展。仪狄对星象的系统观测和记录，为后世天文学家提供了宝贵的经验和方法。他相传发明或改进的观测工具，如土圭等，也为后世天文观测技术的发展奠定了基础。虽然关于仪狄的记载多为传说，但他代表了中国最早的天文历法专家形象，体现了古代中国人对天象的敬畏和对自然规律的探索精神。',
          modelPath: '/models/figures/yidi.glb'
        });
      } else if (figure.name === '周公') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '周代政治家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前1100年-前1015年',
          contribution: figure.contribution || '周公旦是西周初期杰出的政治家、思想家，同时也是重要的天文学家。他创制了"周髀"测影仪，用于测量太阳高度，为中国古代天文观测技术的发展做出了重要贡献。周公还主持制定了完善的历法系统，将天文观测与农业生产紧密结合，奠定了中国古代天文历法的基础。他的天文成就被记载在《周髀算经》等古籍中，对后世产生了深远影响。',
          achievements: [
            '周髀测影仪：创制"周髀"测影仪，用于测量太阳高度和季节变化',
            '历法制定：主持制定西周历法，完善了夏商时期的历法系统',
            '天文观测：系统观测和记录天象，为农业生产提供指导',
            '星象研究：研究恒星位置和运动规律，完善了二十八宿系统'
          ],
          biography: '周公旦（约公元前1100年-前1015年），姬姓，名旦，周文王之子，周武王之弟，被尊称为"周公"。周武王灭商后不久去世，其子成王年幼，周公辅政，成为西周初期的实际统治者。作为政治家，周公平定了武庚和管蔡之乱，制礼作乐，建立了完善的西周礼制。作为思想家，他倡导"敬天保民"的思想，强调统治者应当顺应天意，关心百姓。作为天文学家，周公精通天文历法，创制了"周髀"测影仪，用于测量太阳高度，观测季节变化。他主持制定了西周历法，完善了夏商时期的历法系统，将天文观测与农业生产紧密结合。周公的天文成就被记载在《周髀算经》等古籍中，虽然现存《周髀算经》成书于汉代，但其中保存了周公时期的天文观测方法和理论。周公去世后被后世尊为"圣人"，与孔子并称，其天文成就也成为中国古代天文学的重要组成部分。',
          impact: '周公的天文成就对中国古代天文学的发展产生了深远影响。他创制的"周髀"测影仪是中国最早的天文观测仪器之一，为后世天文观测技术的发展奠定了基础。周公主持制定的西周历法，完善了夏商时期的历法系统，将天文观测与农业生产紧密结合，形成了中国古代天文历法的基本特点。《周髀算经》中记载的周公问答，反映了西周时期的宇宙观和天文知识，成为中国古代天文学的重要文献。周公对恒星位置和运动规律的研究，完善了二十八宿系统，为后世天文观测提供了重要参考。周公将天文与政治、伦理相结合的思想，影响了中国古代天文学的发展方向，形成了"天人合一"的传统。虽然周公的许多天文成就已经难以考证，但他在中国古代天文学史上的地位不容忽视，被后世尊为中国古代天文学的奠基人之一。',
          modelPath: '/models/figures/zhougong.glb'
        });
      } else if (figure.name === '甘德') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '战国时期著名天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前4世纪-前3世纪',
          contribution: figure.contribution || '甘德是战国时期著名的天文学家，与石申并称"甘石"。他系统观测和记录了恒星位置，编制了中国最早的星表《甘德星经》，详细记录了恒星的位置和亮度。甘德对二十八宿系统进行了完善，为中国古代天文学的发展奠定了重要基础。他的观测记录精确详实，对后世天文学研究产生了深远影响。',
          achievements: [
            '星表编制：编制《甘德星经》，详细记录了800多颗恒星的位置和亮度',
            '二十八宿研究：完善二十八宿系统，确立了恒星分区的标准',
            '天象观测：系统观测和记录日食、月食、彗星等天象',
            '行星运动：研究五大行星的运行规律，预测其位置变化'
          ],
          biography: '甘德（约公元前4世纪-前3世纪），战国时期魏国人，中国古代著名天文学家。他与楚国天文学家石申齐名，合称"甘石"。甘德长期从事天文观测工作，系统记录了恒星位置和亮度，编制了中国最早的星表《甘德星经》，记录了约800颗恒星。他对二十八宿系统进行了完善，确立了恒星分区的标准，为中国古代天文学的发展奠定了重要基础。甘德还详细观测和记录了日食、月食、彗星等天象，研究了五大行星的运行规律。《史记·天官书》中记载："甘德、石申星术，甘德在魏，石申在楚。"司马迁评价他们"为天官书，以考星气"，反映了甘德在天文学上的重要地位。虽然原著《甘德星经》已经失传，但其内容被后世天文著作广泛引用，成为中国古代天文学的重要文献。甘德的观测方法和理论对后世天文学家产生了深远影响，被后人尊为中国古代天文学的奠基人之一。',
          impact: '甘德的天文成就对中国古代天文学的发展产生了深远影响。他编制的《甘德星经》是中国最早的星表之一，详细记录了恒星的位置和亮度，为后世天文观测提供了重要参考。甘德对二十八宿系统的完善，确立了中国古代天文学的基本框架，影响了此后两千多年的天文观测和历法制定。他对日食、月食、彗星等天象的系统观测和记录，积累了丰富的天文数据，为后世研究天象规律提供了宝贵资料。甘德研究五大行星运行规律的方法，推动了中国古代行星天文学的发展。虽然甘德的原著已经失传，但他的天文成就通过《史记·天官书》等文献流传下来，成为中国古代天文学的重要组成部分。甘德与石申并称的"甘石"星学传统，对中国古代天文学的发展产生了持久影响，奠定了中国古代观测天文学的基础。',
          modelPath: '/models/figures/gande.glb'
        });
      } else if (figure.name === '石申') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '战国时期著名天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前4世纪-前3世纪',
          contribution: figure.contribution || '石申是战国时期楚国著名的天文学家，与魏国天文学家甘德齐名，合称"甘石"。他系统观测记录了天象变化，编制了《石申天文》，详细记录了恒星位置和天象规律。石申对二十八宿系统进行了完善，为中国古代天文学的发展做出了重要贡献。他的观测记录精确详实，成为后世天文学研究的重要参考。',
          achievements: [
            '天文著作：编撰《石申天文》，系统记录天象观测结果',
            '二十八宿研究：完善二十八宿系统，确立了恒星分区标准',
            '天象观测：系统观测和记录日食、月食、彗星等天象',
            '星象预测：根据天象变化预测气象和农事时机'
          ],
          biography: '石申（约公元前4世纪-前3世纪），战国时期楚国人，中国古代著名天文学家。他与魏国天文学家甘德齐名，合称"甘石"。石申长期从事天文观测工作，系统记录了恒星位置和天象变化，编撰了《石申天文》。他对二十八宿系统进行了完善，确立了恒星分区的标准，为中国古代天文学的发展奠定了重要基础。石申还详细观测和记录了日食、月食、彗星等天象，研究了天象与气象、农事的关系。《史记·天官书》中记载："甘德、石申星术，甘德在魏，石申在楚。"司马迁评价他们"为天官书，以考星气"，反映了石申在天文学上的重要地位。虽然原著《石申天文》已经失传，但其内容被后世天文著作广泛引用，成为中国古代天文学的重要文献。石申的观测方法和理论对后世天文学家产生了深远影响，被后人尊为中国古代天文学的奠基人之一。',
          impact: '石申的天文成就对中国古代天文学的发展产生了深远影响。他编撰的《石申天文》是中国最早的天文著作之一，系统记录了天象观测结果，为后世天文研究提供了重要参考。石申对二十八宿系统的完善，确立了中国古代天文学的基本框架，影响了此后两千多年的天文观测和历法制定。他对日食、月食、彗星等天象的系统观测和记录，积累了丰富的天文数据，为后世研究天象规律提供了宝贵资料。石申研究天象与气象、农事关系的方法，推动了中国古代天文学与农业生产的结合。虽然石申的原著已经失传，但他的天文成就通过《史记·天官书》等文献流传下来，成为中国古代天文学的重要组成部分。石申与甘德并称的"甘石"星学传统，对中国古代天文学的发展产生了持久影响，奠定了中国古代观测天文学的基础。',
          modelPath: '/models/figures/shishen.glb'
        });
      } else if (figure.name === '邹衍') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '战国时期思想家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前305年-前240年',
          contribution: figure.contribution || '邹衍是战国时期著名的思想家，提出了"五德终始"说，将天象变化与政治变革联系起来。他系统观察天象，认为天象的变化反映了人间政治的兴衰更替，建立了一套天人感应的理论体系。邹衍的思想对中国古代天文学与政治哲学的结合产生了深远影响，成为后世天人合一思想的重要来源。',
          achievements: [
            '五德终始说：创立五德相生相克理论，解释朝代更替与天象变化的关系',
            '天象观测：系统观察天象变化，记录天文现象',
            '天人感应：建立天象变化与人间政治关联的理论体系',
            '历法研究：参与战国时期历法改革，完善季节划分'
          ],
          biography: '邹衍（约公元前305年-前240年），战国时期齐国人，中国古代著名思想家、天文学家，阴阳家学派的代表人物。他曾游历各国，在燕、赵等国受到国君礼遇。邹衍提出了"五德终始"说，认为五行（金、木、水、火、土）轮流主宰世界，每个朝代都有其对应的德性，朝代更替遵循五行相生相克的规律。他将天象变化与政治变革紧密联系，认为天象的异常变化是对人间政治的警示或预兆。邹衍系统观察记录了天象变化，包括日月运行、星辰变位、气象异常等现象，并试图从中找出规律。《史记·孟子荀卿列传》中有专门记载："邹衍称为显学，诸侯不能致，而贵显之。"邹衍的思想对秦汉时期的政治哲学产生了重要影响，特别是对董仲舒的天人感应理论有直接启发。虽然邹衍的原著已经失传，但他的思想通过《史记》《汉书》等文献得以保存和传播，成为中国古代天文学与政治哲学结合的重要代表。',
          impact: '邹衍的"五德终始"说对中国古代天文学和政治哲学的发展产生了深远影响。他将天象变化与政治变革联系起来的思想，成为后世天人感应理论的重要来源，特别是对汉代董仲舒的天人三策理论有直接启发。邹衍的理论为中国古代天文学注入了政治哲学的内涵，使天文观测不仅仅是对自然现象的记录，更成为政治决策的重要参考。这种将天文与政治结合的思想，影响了中国古代两千多年的政治文化和天文发展。邹衍对天象的系统观察和记录，积累了丰富的天文数据，为后世研究天象规律提供了参考。虽然邹衍的原著已经失传，但他的思想通过《史记》《汉书》等文献流传下来，成为中国古代天文学和政治哲学的重要组成部分。邹衍的"五德终始"说在秦汉时期被广泛接受，成为解释朝代更替的重要理论，对中国古代政治文化产生了持久影响。',
          modelPath: '/models/figures/zouyan.glb'
        });
      } else if (figure.name === '张衡') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '东汉科学家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '78年-139年',
          contribution: figure.contribution || '张衡是东汉时期杰出的科学家、天文学家和文学家，发明了浑天仪和地动仪等重要科学仪器。他著有《灵宪》等天文著作，系统阐述了浑天说宇宙模型，对恒星、行星运动进行了深入研究。张衡还首次记录了月球不发光而是反射太阳光的科学认识，并对银河系进行了观测研究。他的科学成就代表了东汉时期中国科学技术的最高水平，对后世产生了深远影响。',
          achievements: [
            '浑天仪：发明浑天仪，用于模拟天体运行，观测天象变化',
            '地动仪：发明世界上第一台地震仪，能够测定地震方向',
            '浑天说：系统阐述浑天说宇宙模型，认为天体呈球形，地在其中',
            '天文著作：著有《灵宪》《浑天仪图注》等重要天文著作',
            '月光理论：首次明确提出月球不发光而是反射太阳光的科学认识'
          ],
          biography: '张衡（78年-139年），字平子，南阳西鄂（今河南南阳）人，东汉时期杰出的科学家、天文学家、文学家和发明家。他曾任太史令（掌管天文历法的官职），精通天文、地理、数学、机械等多个领域。张衡最著名的发明是浑天仪和地动仪。浑天仪是一种模拟天体运行的精密仪器，可以观测天象变化；地动仪则是世界上第一台地震仪，能够测定地震方向，比西方早1700多年。在天文学方面，张衡系统阐述了浑天说宇宙模型，认为天体呈球形，地在其中，并对恒星、行星运动进行了深入研究。他在《灵宪》中首次明确提出月球不发光而是反射太阳光的科学认识，并对银河系进行了观测研究。张衡还精通文学，著有《二京赋》《归田赋》等名篇，是东汉文学的代表人物。他一生致力于科学研究和文学创作，被后世誉为"科圣"，其科学成就代表了东汉时期中国科学技术的最高水平。',
          impact: '张衡的科学成就对中国古代天文学和地震学的发展产生了深远影响。他发明的浑天仪成为中国古代最重要的天文观测仪器之一，被后世不断改进和使用，直到明清时期。地动仪的发明则开创了世界地震仪器观测的先河，比西方早1700多年，体现了中国古代科学技术的先进性。张衡系统阐述的浑天说宇宙模型成为中国古代主流的宇宙观，影响了此后一千多年的天文学发展。他在《灵宪》中提出的月球反射太阳光的理论是重要的科学发现，显示了他的科学思想超越了当时的认知水平。张衡对恒星和行星运动的研究为后世天文学家提供了重要参考，他记录的天文现象也为现代天文学研究提供了宝贵的历史资料。作为一位集科学家、文学家于一身的全才，张衡体现了中国古代知识分子的综合素养，他的成就不仅在中国科学史上占有重要地位，在世界科学史上也有重要影响。',
          modelPath: '/models/figures/zhanghen.glb'
        });
      } else if (figure.name === '落下闳') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '西汉天文学家、历法专家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前156年-前87年',
          contribution: figure.contribution || '落下闳是西汉时期杰出的天文学家和历法专家，主持制定了中国古代具有里程碑意义的《太初历》。他通过精确观测天象，确定了回归年的长度为365又1/4天，并将二十四节气纳入历法体系，使历法与农业生产紧密结合。落下闳还改进了天文观测仪器，提高了观测精度，为中国古代天文历法的发展做出了重要贡献。他的历法成就代表了西汉时期中国天文学的最高水平，影响了此后一千多年的历法制定。',
          achievements: [
            '太初历：主持制定《太初历》，确立了365.25天的回归年长度',
            '二十四节气：完善二十四节气系统，将其纳入历法体系',
            '天文观测：改进观测仪器，提高天文观测精度',
            '岁差发现：可能是世界上最早发现岁差现象的天文学家之一',
            '历法改革：将天文观测与历法制定紧密结合，建立科学历法体系'
          ],
          biography: '落下闳（约公元前156年-前87年），本名闳，西汉时期杰出的天文学家和历法专家。据《汉书·律历志》记载，他原是西域大宛国人，因精通天文历法被汉武帝征召入朝。"落下"是他的封号，意为"从天而降的贤人"。落下闳在汉武帝太初元年（公元前104年）主持制定了《太初历》，这是中国历史上第一部有完整记载的历法，具有里程碑意义。他通过精确观测天象，确定了回归年的长度为365又1/4天（365.25天），这一数值与现代测量结果非常接近。落下闳还将二十四节气系统化并纳入历法体系，使历法与农业生产紧密结合。在天文观测方面，他改进了简仪等观测工具，提高了观测精度，并可能是世界上最早发现岁差现象的天文学家之一。落下闳的历法成就代表了西汉时期中国天文学的最高水平，《太初历》成为此后一千多年中国历法的基础，对中国古代天文学的发展产生了深远影响。',
          impact: '落下闳的历法成就对中国古代天文学的发展产生了深远影响。他主持制定的《太初历》是中国历史上第一部有完整记载的历法，确立了365.25天的回归年长度，这一数值与现代测量结果非常接近，体现了中国古代天文学的精确性。《太初历》成为此后一千多年中国历法的基础，历代历法都是在其基础上进行改进和完善。落下闳将二十四节气系统化并纳入历法体系，使历法与农业生产紧密结合，形成了中国古代天文历法的重要特点。他在天文观测方面的贡献，特别是对岁差现象的可能发现，显示了他的观测精度和科学思想超越了当时的认知水平。落下闳的历法改革将天文观测与历法制定紧密结合，建立了科学的历法体系，为后世天文历法的发展奠定了重要基础。作为一位来自西域的天文学家，落下闳的成就也体现了中国古代天文学对外来知识的吸收和融合，展示了中国古代科学的开放性和包容性。',
          modelPath: '/models/figures/luoxiahong.glb'
        });
      } else if (figure.name === '刘向') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '西汉学者、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前77年-前6年',
          contribution: figure.contribution || '刘向是西汉时期杰出的学者、天文学家和文献整理专家，主持校订了大量古代天文文献，著有《五行志》等重要著作。他系统整理了先秦以来的天象记录，对彗星、流星等天文现象进行了详细分类和研究，建立了完整的天文灾异理论体系。刘向还参与了《三统历》的编制工作，对历法改革做出了重要贡献。他的文献整理和天文研究工作为后世天文学的发展奠定了重要基础，对中国古代天文学的传承和发展产生了深远影响。',
          achievements: [
            '文献整理：主持校订古代天文文献，保存了大量珍贵的天文观测记录',
            '彗星研究：系统研究彗星现象，详细记录彗星形态和运行规律',
            '天文灾异：建立完整的天文灾异理论体系，将天象变化与政治事件联系起来',
            '历法研究：参与《三统历》编制，对历法改革做出重要贡献',
            '著述成果：著有《五行志》《洪范五行传》等重要天文著作'
          ],
          biography: '刘向（约公元前77年-前6年），字子政，沛郡（今江苏沛县）人，西汉时期杰出的学者、天文学家和文献整理专家。他出身于汉室宗亲，是汉高祖刘邦的后代，曾任谏大夫、光禄大夫等职。刘向一生致力于文献整理和学术研究，在天文学方面有重要贡献。汉成帝时期，他受命校订秘书中的古籍，主持整理了大量先秦以来的天文文献，保存了珍贵的天文观测记录。刘向对彗星、流星等天文现象进行了详细分类和研究，在《五行志》中系统记录了天象变化与政治事件的关系，建立了完整的天文灾异理论体系。他还参与了《三统历》的编制工作，对历法改革做出了重要贡献。刘向的天文研究与他的政治思想密切相关，他认为天象变化反映了人间政治的得失，是上天对人间政治的警示。除天文研究外，刘向还整理编纂了《战国策》《列女传》《说苑》等重要著作，是西汉时期最重要的学者之一。他的儿子刘歆继承了他的学术事业，父子二人的文献整理和天文研究工作对中国古代学术的发展产生了深远影响。',
          impact: '刘向的天文研究和文献整理工作对中国古代天文学的发展产生了深远影响。他主持校订的古代天文文献保存了大量珍贵的天文观测记录，为后世天文学研究提供了重要资料。刘向对彗星、流星等天文现象的系统研究，详细记录了彗星形态和运行规律，为中国古代彗星学的发展奠定了基础。他在《五行志》中建立的天文灾异理论体系，将天象变化与政治事件联系起来，成为汉代以后天人感应理论的重要组成部分，对中国古代政治文化产生了深远影响。刘向参与《三统历》编制的工作，对历法改革做出了重要贡献，推动了中国古代历法的发展。他的著作《五行志》《洪范五行传》等成为后世研究天文灾异理论的重要文献，被后世天文学家广泛引用。刘向的文献整理工作保存了大量先秦以来的天文知识，为中国古代天文学的传承和发展做出了不可磨灭的贡献。作为一位集政治家、学者、天文学家于一身的人物，刘向体现了中国古代知识分子的综合素养，他的成就在中国学术史和科学史上占有重要地位。',
          modelPath: '/models/figures/liuxiang.glb'
        });
      } else if (figure.name === '刘歆') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '西汉学者、天文历法专家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约公元前50年-23年',
          contribution: figure.contribution || '刘歆是西汉末年至新朝初期杰出的学者、天文历法专家和文献整理专家，是刘向之子，继承并发展了父亲的学术事业。他主持编制了《三统历》，这是中国古代具有重要影响的历法之一，系统阐述了天文历法的理论基础。刘歆还创立了"七部"学术分类法，对古代文献进行了系统整理，保存了大量珍贵的天文观测记录。他对恒星、行星运动规律进行了深入研究，完善了二十八宿系统，为中国古代天文学的发展做出了重要贡献。',
          achievements: [
            '三统历：主持编制《三统历》，系统阐述天文历法理论',
            '文献整理：创立"七部"学术分类法，整理保存古代天文文献',
            '星象研究：深入研究恒星、行星运动规律，完善二十八宿系统',
            '天文仪器：改进浑天仪等天文观测仪器，提高观测精度',
            '学术传承：继承发展刘向的天文灾异理论，形成完整的理论体系'
          ],
          biography: '刘歆（约公元前50年-23年），字子骏，沛郡（今江苏沛县）人，西汉末年至新朝初期杰出的学者、天文历法专家和文献整理专家，是著名学者刘向之子。刘歆继承了父亲的学术事业，在文献整理和天文历法研究方面取得了重要成就。他曾任侍中、奉车都尉等职，后来支持王莽篡汉，被封为礼乐侯，任大司空、国师等职。刘歆主持编制了《三统历》，这是中国古代具有重要影响的历法之一，系统阐述了天文历法的理论基础，将三统（夏、商、周）的历法系统化。在文献整理方面，刘歆创立了"七部"学术分类法（即《七略》），对古代文献进行了系统整理，保存了大量珍贵的天文观测记录。他还完成了父亲未竟的校书事业，编纂了《西京杂记》《西汉外戚传》等著作。在天文研究方面，刘歆对恒星、行星运动规律进行了深入研究，完善了二十八宿系统，改进了浑天仪等天文观测仪器。他继承并发展了父亲刘向的天文灾异理论，形成了更加完整的理论体系。刘歆在学术上的贡献是多方面的，他不仅精通天文历法，还通晓经学、文学、历史等多个领域，是西汉末年最博学的学者之一。王莽篡位后，刘歆积极参与新朝的政治改革，但最终因政治斗争被杀，其学术成就却对后世产生了深远影响。',
          impact: '刘歆的天文历法研究和文献整理工作对中国古代天文学的发展产生了深远影响。他主持编制的《三统历》是中国古代具有重要影响的历法之一，系统阐述了天文历法的理论基础，为后世历法制定提供了重要参考。刘歆创立的"七部"学术分类法对古代文献进行了系统整理，保存了大量珍贵的天文观测记录，为后世天文学研究提供了宝贵资料。他对恒星、行星运动规律的深入研究，完善了二十八宿系统，推动了中国古代天文学的发展。刘歆改进的浑天仪等天文观测仪器，提高了观测精度，为天文观测技术的进步做出了贡献。他继承并发展了父亲刘向的天文灾异理论，形成了更加完整的理论体系，对汉代以后的天文学和政治文化产生了重要影响。刘歆的学术成就不仅在天文历法领域，还涉及经学、文学、历史等多个方面，体现了中国古代知识分子的综合素养。虽然刘歆因政治原因最终遭到不幸，但他的学术贡献被后世所重视，成为中国古代天文学和学术史上的重要人物。刘向、刘歆父子的学术传承，代表了西汉时期学术研究的最高水平，对中国古代学术的发展产生了持久影响。',
          modelPath: '/models/figures/liuxin.glb'
        });
      } else if (figure.name === '祖冲之') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '南北朝数学家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '429年-500年',
          contribution: figure.contribution || '祖冲之是南北朝时期杰出的数学家、天文学家，在圆周率计算、历法改革和天文观测等方面取得了重大成就。他计算出圆周率的精确值在3.1415926与3.1415927之间，被称为"祖率"，是当时世界上最精确的圆周率值。祖冲之还主持编制了《大明历》，改进了天文观测仪器，对恒星、行星运动规律进行了深入研究，为中国古代天文学和数学的发展做出了重要贡献。他的科学成就代表了南北朝时期中国科学技术的最高水平，对后世产生了深远影响。',
          achievements: [
            '圆周率：计算出圆周率精确值在3.1415926与3.1415927之间，创"祖率"',
            '大明历：主持编制《大明历》，改革历法，提高历法精度',
            '天文观测：改进天文观测仪器，提高观测精度',
            '岁差研究：深入研究岁差现象，对恒星位置变化进行精确测量',
            '数学著作：著有《缀术》等重要数学著作，系统阐述数学理论'
          ],
          biography: '祖冲之（429年-500年），字文远，范阳郡遒县（今河北涞水）人，南北朝时期杰出的数学家、天文学家和机械制造专家。他出身于官宦世家，年轻时就表现出非凡的数学天赋。祖冲之在数学方面的最大成就是计算圆周率，他通过割圆术，计算出圆周率的精确值在3.1415926与3.1415927之间，取近似值为355/113（密率）和22/7（约率），合称"祖率"，这一成就比西方早了一千多年。在天文学方面，祖冲之主持编制了《大明历》，这是中国古代具有重要影响的历法之一，改进了此前历法中存在的问题，提高了历法精度。他还改进了天文观测仪器，对恒星、行星运动规律进行了深入研究，特别是对岁差现象的研究，对恒星位置变化进行了精确测量。祖冲之还是一位机械制造专家，据记载他制造了"木牛流马"等机械装置，展示了非凡的工程才能。他著有《缀术》《大明历经》等重要著作，系统阐述了数学和天文学理论，但大部分已经失传，仅在后世文献中有所引用。祖冲之一生致力于科学研究，被后世誉为"南北朝第一科学家"，其科学成就代表了南北朝时期中国科学技术的最高水平。',
          impact: '祖冲之的科学成就对中国古代数学和天文学的发展产生了深远影响。他计算的圆周率精确值在3.1415926与3.1415927之间，被称为"祖率"，是当时世界上最精确的圆周率值，比西方早了一千多年，体现了中国古代数学的先进性。祖率在中国使用了近一千年，直到明末西方数学传入中国才被更精确的值所取代。祖冲之主持编制的《大明历》是中国古代具有重要影响的历法之一，改进了此前历法中存在的问题，提高了历法精度，为后世历法制定提供了重要参考。他对岁差现象的研究和对恒星位置变化的精确测量，推动了中国古代天文学的发展。祖冲之改进的天文观测仪器，提高了观测精度，为天文观测技术的进步做出了贡献。他的著作《缀术》《大明历经》等虽然大部分已经失传，但其中的数学和天文学理论通过后世文献的引用得以部分保存，对后世科学研究产生了重要影响。作为一位集数学家、天文学家和机械制造专家于一身的全才，祖冲之体现了中国古代科学家的综合素养，他的成就不仅在中国科学史上占有重要地位，在世界科学史上也有重要影响。',
          modelPath: '/models/figures/zuchongzhi.glb'
        });
      } else if (figure.name === '何承天') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '南朝宋天文学家、历法专家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '370年-447年',
          contribution: figure.contribution || '何承天是南朝宋时期杰出的天文学家和历法专家，主持编制了具有重要历史意义的《元嘉历》。他通过精确观测天象，改进了历法计算方法，提高了历法精度，使历法与农业生产更加紧密结合。何承天还系统研究了二十八宿系统，对恒星位置进行了精确测量，完善了天文观测方法。他在天文历法方面的成就代表了南朝时期中国天文学的高水平，对后世历法的发展产生了重要影响。',
          achievements: [
            '元嘉历：主持编制《元嘉历》，改进历法计算方法，提高历法精度',
            '二十八宿研究：系统研究二十八宿系统，完善恒星分区标准',
            '天文观测：改进天文观测方法，提高观测精度',
            '历法改革：将天文观测与历法制定紧密结合，建立更科学的历法体系',
            '天文著作：著有《历议》等重要天文著作，系统阐述天文历法理论'
          ],
          biography: '何承天（370年-447年），字伯通，会稽余姚（今浙江余姚）人，南朝宋时期杰出的天文学家、历法专家和文学家。他出身于官宦世家，年轻时就表现出非凡的学术才能。何承天在刘宋王朝担任过太史令、吏部尚书等重要职务，负责天文观测和历法制定工作。他最重要的成就是在宋文帝元嘉年间（424年-453年）主持编制了《元嘉历》，这是南北朝时期具有重要影响的历法之一。《元嘉历》改进了此前历法中存在的问题，提高了历法精度，特别是在朔望月长度和回归年长度的计算上取得了进步。何承天还系统研究了二十八宿系统，对恒星位置进行了精确测量，完善了天文观测方法。他著有《历议》等重要天文著作，系统阐述了天文历法理论，但大部分已经失传，仅在后世文献中有所引用。除了天文历法研究外，何承天还是一位杰出的文学家，著有《答宋文帝〈难何衡阳诗书〉》等文学作品，在文学史上也有一定地位。何承天一生致力于天文历法研究和文学创作，是南朝时期文武兼备的杰出学者，其天文历法成就对后世产生了重要影响。',
          impact: '何承天的天文历法成就对中国古代天文学的发展产生了重要影响。他主持编制的《元嘉历》是南北朝时期具有重要影响的历法之一，改进了此前历法中存在的问题，提高了历法精度，特别是在朔望月长度和回归年长度的计算上取得了进步，为后世历法制定提供了重要参考。《元嘉历》在南朝使用了近百年，直到梁武帝天监年间才被《兴和历》所取代，体现了其实用价值和科学性。何承天对二十八宿系统的系统研究和对恒星位置的精确测量，完善了天文观测方法，推动了中国古代天文学的发展。他改进的天文观测方法，提高了观测精度，为天文观测技术的进步做出了贡献。何承天的著作《历议》等虽然大部分已经失传，但其中的天文历法理论通过后世文献的引用得以部分保存，对后世科学研究产生了重要影响。作为一位集天文学家、历法专家和文学家于一身的全才，何承天体现了中国古代知识分子的综合素养，他的成就在中国科学史和文学史上都占有重要地位。',
          modelPath: '/models/figures/hechentian.glb'
        });
      } else if (figure.name === '虞喜') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '西晋天文学家、宇宙理论家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约281年-356年',
          contribution: figure.contribution || '虞喜是西晋时期杰出的天文学家和宇宙理论家，著有《安天论》，系统发展了浑天说宇宙模型。他通过精确观测天象，对浑天说进行了理论完善，提出了"天如鸡子，地如鸡中黄"的宇宙结构理论，认为天体呈球形，地球悬浮于其中。虞喜还对二十八宿系统进行了深入研究，对恒星位置进行了精确测量，完善了天文观测方法。他在天文理论方面的成就代表了魏晋时期中国天文学的高水平，对后世天文学的发展产生了深远影响。',
          achievements: [
            '浑天说发展：著有《安天论》，系统发展浑天说宇宙模型',
            '宇宙结构理论：提出"天如鸡子，地如鸡中黄"的宇宙结构理论',
            '二十八宿研究：深入研究二十八宿系统，完善恒星分区标准',
            '天文观测：改进天文观测方法，提高观测精度',
            '天文著作：系统阐述天文理论，对后世天文学产生深远影响'
          ],
          biography: '虞喜（约281年-356年），字仲宁，会稽余姚（今浙江余姚）人，西晋末至东晋初期杰出的天文学家和宇宙理论家。他出身于学术世家，年轻时就表现出对天文学的浓厚兴趣。虞喜生活在西晋末年动荡时期，曾避乱江南，后定居会稽。他最重要的成就是著有《安天论》，系统发展了浑天说宇宙模型。在《安天论》中，虞喜提出了"天如鸡子，地如鸡中黄"的宇宙结构理论，认为天体呈球形，地球悬浮于其中，周围环绕着气体，这一理论对当时的宇宙观有重要突破。虞喜还对二十八宿系统进行了深入研究，对恒星位置进行了精确测量，完善了天文观测方法。他对日月运行规律、二十四节气等也有深入研究，提出了许多独到见解。虞喜的天文理论在当时引起了广泛讨论，虽然有些观点受到质疑，但他坚持科学观察和理性思考的态度，对后世天文学的发展产生了深远影响。他的著作《安天论》虽然原本已经失传，但其主要内容通过《晋书·天文志》等文献得以保存，成为研究中国古代天文学和宇宙观的重要资料。',
          impact: '虞喜的天文理论对中国古代天文学的发展产生了深远影响。他在《安天论》中系统发展的浑天说宇宙模型，特别是"天如鸡子，地如鸡中黄"的宇宙结构理论，对中国古代宇宙观的形成和发展起到了重要作用。这一理论认为天体呈球形，地球悬浮于其中，周围环绕着气体，这种观点比当时流行的"盖天说"（认为天如覆盖，地如棋盘）更加科学，为后世天文学家提供了重要的理论基础。虞喜对二十八宿系统的深入研究和对恒星位置的精确测量，完善了天文观测方法，推动了中国古代天文学的发展。他改进的天文观测方法，提高了观测精度，为天文观测技术的进步做出了贡献。虞喜的著作《安天论》虽然原本已经失传，但其中的天文理论通过《晋书·天文志》等文献得以部分保存，对后世科学研究产生了重要影响。作为一位坚持科学观察和理性思考的天文学家，虞喜在中国科学史上占有重要地位，他的成就为中国古代天文学的发展做出了重要贡献。',
          modelPath: '/models/figures/yuxi.glb'
        });
      } else if (figure.name === '一行') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '唐代高僧、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '683年-727年',
          contribution: figure.contribution || '一行是唐代杰出的高僧、天文学家和数学家，主持编制了《大衍历》，这是当时世界上最精确的历法之一。他进行了大规模的天文测量活动，测量了子午线长度，为确定地球形状提供了重要数据。一行还发明和改进了多种天文仪器，提高了天文观测的精度。他在天文学、数学和佛学等多个领域都有深入研究，是唐代科学的代表人物之一，对中国古代天文学的发展做出了重大贡献。',
          achievements: [
            '大衍历编制：主持编制《大衍历》，是当时世界上最精确的历法之一',
            '天文测量：进行大规模天文测量，测量子午线长度，为确定地球形状提供重要数据',
            '仪器改进：发明和改进多种天文仪器，提高观测精度',
            '交食预测：改进日食和月食的预测方法，提高预测准确性',
            '数学研究：在数学领域有重要贡献，特别是在球面三角学方面'
          ],
          biography: '一行（683年-727年），俗姓张，名遂，唐代杰出的高僧、天文学家和数学家。他出生于邢州（今河北邢台），年轻时就表现出非凡的学术才能。一行早年出家为僧，精通佛学，后来因其在天文学和数学方面的才能被唐玄宗召入宫廷，担任太史令，负责天文观测和历法制定工作。他最重要的成就是在开元十二年（724年）主持编制了《大衍历》，这是当时世界上最精确的历法之一，改进了此前历法中存在的问题，特别是在交食预测方面取得了重大进步。一行还进行了大规模的天文测量活动，在全国范围内设立了十多个观测站，测量了子午线长度，为确定地球形状提供了重要数据。他发明和改进了多种天文仪器，如简仪、浑天仪等，提高了天文观测的精度。一行在数学领域也有重要贡献，特别是在球面三角学方面的研究，为天文计算提供了数学基础。除了科学研究外，一行还是一位杰出的佛学大师，著有《大毗卢遮那成佛神变加持经疏》等佛学著作。一行一生致力于科学研究和佛学修行，是唐代科学的代表人物之一，被后人尊为"天下第一人"。',
          impact: '一行的天文成就对中国古代天文学的发展产生了深远影响。他主持编制的《大衍历》是当时世界上最精确的历法之一，改进了此前历法中存在的问题，特别是在交食预测方面取得了重大进步，为后世历法制定提供了重要参考。一行进行的大规模天文测量活动，测量了子午线长度，为确定地球形状提供了重要数据，这在当时世界天文学史上具有重要意义。他发明和改进的多种天文仪器，如简仪、浑天仪等，提高了天文观测的精度，推动了天文观测技术的发展。一行在数学领域的贡献，特别是在球面三角学方面的研究，为天文计算提供了数学基础，促进了数学和天文学的结合。作为一位集高僧、天文学家和数学家于一身的全才，一行体现了中国古代知识分子的综合素养，他的成就不仅在中国科学史上占有重要地位，在世界科学史上也有一定影响。一行的科学精神和研究方法，对后世科学家产生了深远影响，他被后人尊为"天下第一人"，反映了他在中国古代科学史上的崇高地位。',
          modelPath: '/models/figures/yixing.glb'
        });
      } else if (figure.name === '南宫说') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '唐代天文学家、历法专家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约685年-729年',
          contribution: figure.contribution || '南宫说是唐代杰出的天文学家和历法专家，与一行禅师合作创制了《大衍历》，这是当时世界上最精确的历法之一。他在天文观测和历法计算方面有深厚造诣，特别是在交食预测方面取得了重大突破。南宫说还参与了唐朝大规模的天文测量活动，为确定地球形状提供了重要数据。他在天文仪器改进和天象记录方面也有重要贡献，是唐代天文学发展的重要推动者。',
          achievements: [
            '大衍历创制：与一行合作创制《大衍历》，改进历法计算方法，提高历法精度',
            '交食预测：改进日食和月食的预测方法，提高预测准确性',
            '天文测量：参与大规模天文测量活动，为确定地球形状提供重要数据',
            '仪器改进：改进天文观测仪器，提高观测精度',
            '天象记录：系统记录天象变化，为后世天文研究提供重要资料'
          ],
          biography: '南宫说（约685年-729年），唐代杰出的天文学家和历法专家。他出身于世代从事天文工作的家族，年轻时就表现出对天文学的浓厚兴趣和非凡才能。南宫说在唐玄宗时期担任太史局官员，负责天文观测和历法制定工作。他最重要的成就是在开元十二年（724年）与一行禅师合作创制了《大衍历》，这是当时世界上最精确的历法之一。《大衍历》改进了此前历法中存在的问题，特别是在交食预测方面取得了重大突破，引入了新的计算方法，大大提高了预测准确性。南宫说还参与了唐朝大规模的天文测量活动，在全国范围内设立观测站，测量天体位置和子午线长度，为确定地球形状提供了重要数据。他在天文仪器方面也有贡献，改进了简仪、浑天仪等观测工具，提高了天文观测的精度。南宫说还系统记录了天象变化，包括日食、月食、彗星和超新星等，为后世天文研究提供了重要资料。虽然南宫说的生平资料相对较少，但从他与一行的合作以及《大衍历》的成就来看，他无疑是唐代最重要的天文学家之一，对中国古代天文学的发展做出了重要贡献。',
          impact: '南宫说的天文成就对中国古代天文学的发展产生了重要影响。他与一行合作创制的《大衍历》是当时世界上最精确的历法之一，改进了此前历法中存在的问题，特别是在交食预测方面取得了重大突破，引入了新的计算方法，大大提高了预测准确性，为后世历法制定提供了重要参考。《大衍历》的回归年长度为365.2446天，与现代测量值365.2422天非常接近，精度达到了99.9993%，这在当时世界天文学史上是非常了不起的成就。南宫说参与的唐朝大规模天文测量活动，测量了天体位置和子午线长度，为确定地球形状提供了重要数据，这在当时世界天文学史上具有重要意义。他在天文仪器方面的改进，提高了天文观测的精度，推动了天文观测技术的发展。南宫说系统记录的天象变化，包括日食、月食、彗星和超新星等，为后世天文研究提供了重要资料，对中国古代天文学的发展做出了重要贡献。虽然南宫说的名声不如一行那么显赫，但他在中国天文学史上的地位不容忽视，是唐代天文学发展的重要推动者之一。',
          modelPath: '/models/figures/nangongshuo.glb'
        });
      } else if (figure.name === '李淳风') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '唐代天文学家、数学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '602年-670年',
          contribution: figure.contribution || '李淳风是唐代杰出的天文学家、数学家和历法专家，编制了具有重要历史意义的《麟德历》。他通过改进天文观测仪器，创造性地设计了"三重环"浑天仪，提高了天文观测的精度。李淳风还注释整理了《算经十书》，保存了中国古代珍贵的数学文献。他著有《乙巳占》等天文著作，系统记录了天象变化规律，对气象学的发展做出了开创性贡献。李淳风在天文学、数学和历法等多个领域都有深入研究，是唐代科学的代表人物之一，对中国古代科学的发展产生了深远影响。',
          achievements: [
            '麟德历编制：主持编制《麟德历》，改进历法计算方法，提高历法精度',
            '三重环浑天仪：创造性地设计"三重环"浑天仪，提高天文观测精度',
            '算经十书注释：注释整理《算经十书》，保存中国古代珍贵数学文献',
            '乙巳占著作：著有《乙巳占》等天文著作，系统记录天象变化规律',
            '气象学贡献：首创风力等级划分标准，对气象学发展做出开创性贡献'
          ],
          biography: '李淳风（602年-670年），字道之，岐州雍县（今陕西凤翔）人，唐代杰出的天文学家、数学家和历法专家。他的父亲李播是隋朝高唐县尉，后弃官为道士，号黄冠子，著有《天文大象赋》。李淳风早年学道于天台山，受父亲影响，对天文、历算和阴阳学说有浓厚兴趣。他最初在隋炀帝时期担任司监官，后来因其在天文学和数学方面的才能被重用。贞观元年（627年），李淳风因批评《戊寅元历》的缺陷而被任命到太史局工作。贞观七年（633年），他创造性地设计了"三重环"浑天仪，在传统浑天仪的基础上增加了黄道环，大大提高了天文观测的精度。贞观十五年（641年），李淳风任太史丞，撰写研究浑天仪的《法象志》。贞观二十二年（648年），他升任太史令，奉诏注释《算经十书》，保存了中国古代珍贵的数学文献。李淳风还参与编纂了《晋书》和《隋书》中的天文志、历志等部分。唐高宗时期，李淳风编制了《麟德历》，麟德二年（665年）正式颁行，使用至开元十六年（728年）。此外，李淳风还著有《乙巳占》、《推背图》（与袁天罡合著）等著作，系统记录了天象变化规律，对后世产生了深远影响。李淳风一生致力于天文历法和数学研究，是唐代科学的代表人物之一，于670年在长安去世。',
          impact: '李淳风的科学成就对中国古代科学的发展产生了深远影响。他编制的《麟德历》是唐代重要的历法之一，改进了此前历法中存在的问题，提高了历法精度，为后世历法制定提供了重要参考。《麟德历》使用了"定朔"的方法，每三年设置一个闰月，使历法更加符合天象变化，在当时具有很高的科学价值。李淳风创造性地设计的"三重环"浑天仪，在传统浑天仪的基础上增加了黄道环，大大提高了天文观测的精度，推动了天文观测技术的发展。他注释整理的《算经十书》保存了中国古代珍贵的数学文献，对中国数学史的研究具有重要价值。李淳风著有《乙巳占》等天文著作，系统记录了天象变化规律，特别是在气象学方面的贡献尤为突出。他首创了风力等级划分标准，这一标准与现代气象学中的风力等级划分理论基本一致，被认为是世界气象学史上的重要贡献。李淳风在天文学、数学和历法等多个领域都有深入研究，体现了中国古代科学家的综合素养，他的成就不仅在中国科学史上占有重要地位，在世界科学史上也有一定影响。李淳风的科学精神和研究方法，对后世科学家产生了深远影响，他被后人尊为唐代科学的代表人物之一。',
          modelPath: '/models/figures/lichunfeng.glb'
        });
      } else if (figure.name === '袁天罡') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '唐代天文学家、占卜家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约585年-约670年',
          contribution: figure.contribution || '袁天罡是唐代著名的天文学家和占卜家，精通天象观测和预测。他与李淳风合作，系统观测和记录了天象变化，为唐代天文学的发展做出了重要贡献。袁天罡在天文观测方面有独到的见解，能够通过观测天象预测自然灾害和社会变化。他与李淳风合著的《推背图》是中国古代著名的预言著作，融合了天文学、易学和历史学知识，对后世产生了深远影响。袁天罡还参与了唐初历法的改革工作，为提高历法精度做出了贡献。他在星象学和占卜术方面的成就，使他成为唐代最著名的天文学家之一。',
          achievements: [
            '天象观测：系统观测和记录天象变化，为唐代天文学发展做出重要贡献',
            '推背图著作：与李淳风合著《推背图》，融合天文学、易学和历史学知识',
            '历法改革：参与唐初历法改革工作，为提高历法精度做出贡献',
            '灾害预测：通过观测天象预测自然灾害，为减轻灾害影响提供参考',
            '星象研究：在星象学和占卜术方面有深入研究，成为唐代著名天文学家'
          ],
          biography: '袁天罡（约585年-约670年），唐代著名的天文学家和占卜家，洛阳（今河南洛阳）人。他出身于世代习天文之家，自幼受到良好的天文学教育，精通天文、历算和占卜之术。隋末唐初，袁天罡因其精准的天象预测而闻名，被唐高祖李渊征召入宫，担任太史局官员，负责观测天象和预测吉凶。唐太宗贞观年间，袁天罡与李淳风共事于太史局，两人志同道合，合作无间，共同观测天象，研究历法，著有多部天文著作。袁天罡在天文观测方面有独到的见解，能够通过观测天象预测自然灾害和社会变化，多次准确预测日食、月食和彗星出现，被时人誉为"神算"。他与李淳风合著的《推背图》是中国古代著名的预言著作，以六十个卦象预测未来，融合了天文学、易学和历史学知识，对后世产生了深远影响。袁天罡还参与了唐初历法的改革工作，为提高历法精度做出了贡献。他在星象学和占卜术方面的成就，使他成为唐代最著名的天文学家之一。袁天罡一生致力于天文观测和预测研究，为唐代天文学的发展做出了重要贡献，约在唐高宗麟德年间（664年-665年）去世，终年约85岁。',
          impact: '袁天罡的天文成就对中国古代天文学和文化产生了深远影响。他与李淳风合作，系统观测和记录了天象变化，为唐代天文学的发展奠定了基础。他们合著的《推背图》是中国古代著名的预言著作，以六十个卦象预测未来，融合了天文学、易学和历史学知识，成为中国预言文化的代表作之一，对后世文学、历史和民间信仰产生了深远影响。《推背图》中的许多预言被后人认为准确应验，增强了人们对天文预测的信任，推动了天文学在民间的普及。袁天罡参与的唐初历法改革工作，提高了历法精度，为农业生产和社会生活提供了更准确的时间参考。他通过观测天象预测自然灾害的方法，为减轻灾害影响提供了参考，具有重要的实用价值。袁天罡在星象学和占卜术方面的成就，丰富了中国古代天文学的内容，拓展了天文学的应用范围。他的天文观测方法和预测技术，对后世天文学家产生了深远影响，许多方法被后人继承和发展。袁天罡的天文成就和传奇经历，使他成为中国文化中的重要人物，在民间广为流传，多部文学作品和戏剧以他为原型，塑造了天文学家的形象，推动了天文知识的传播。',
          modelPath: '/models/figures/yuantiangang.glb'
        });
      } else if (figure.name === '沈括') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '北宋科学家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '1031年-1095年',
          contribution: figure.contribution || '沈括是北宋杰出的科学家、天文学家和政治家，著有《梦溪笔谈》等重要著作。他在天文学方面有深入研究，对北极星位置进行了精确测量，发现了磁针的偏角现象，比西方早400多年。沈括还提出了"十二气历"的历法改革建议，对传统历法进行了创新。他在地质学方面提出了地貌形成的自然侵蚀说，解释了华北平原的形成原因。沈括还在数学、物理学、医学等多个领域都有重要贡献，是中国古代最全面的科学家之一，被誉为"中国科学史上的坐标"。',
          achievements: [
            '梦溪笔谈著作：撰写《梦溪笔谈》，系统记录了北宋时期的科学技术成就',
            '天文观测：对北极星位置进行精确测量，发现磁针偏角现象',
            '历法改革：提出"十二气历"的历法改革建议，创新传统历法',
            '地质研究：提出地貌形成的自然侵蚀说，解释华北平原形成原因',
            '多领域贡献：在数学、物理学、医学等多个领域都有重要研究成果'
          ],
          biography: '沈括（1031年-1095年），字存中，号梦溪翁，钱塘（今浙江杭州）人，北宋杰出的科学家、天文学家和政治家。沈括出身于官宦家庭，自幼聪颖好学，博览群书，对天文、地理、数学等自然科学有浓厚兴趣。他曾任昭文馆校勘、提举司天监事、史馆检讨、集贤院校理等职，得以博览群书。沈括积极参与王安石变法，官至翰林学士、权三司使，主管财政经济，又以察访使名义到各地视察新政的实施情况。他注重发展农业，曾主持沭水和芜湖万春圩的水利工程，在变法活动中又主持整治汴渠的工程，并察访两浙路和河北西路的农田水利。沈括掌管过司天监，创造新天文仪器，改革历法，采用卫朴的《奉元历》。他在天文学方面有深入研究，对北极星位置进行了精确测量，发现了磁针的偏角现象，比西方早400多年。沈括还提出了"十二气历"的历法改革建议，对传统历法进行了创新。他在地质学方面提出了地貌形成的自然侵蚀说，解释了华北平原的形成原因。沈括还在数学、物理学、医学等多个领域都有重要贡献，是中国古代最全面的科学家之一。晚年，沈括定居镇江梦溪园，将一生所见所闻及研究心得，写成《梦溪笔谈》，成为中国科学史上的重要著作。沈括于1095年去世，终年65岁。',
          impact: '沈括的科学成就对中国古代科学发展产生了深远影响。他的《梦溪笔谈》是中国古代科学技术的百科全书，系统记录了北宋时期的科学技术成就，涵盖天文、数学、物理、地理、医药和乐律等多个领域，被英国科学史家李约瑟称为"中国科学史上的坐标"。沈括在天文学方面的贡献尤为突出，他对北极星位置进行了精确测量，发现了磁针的偏角现象，比西方早400多年，为航海技术的发展奠定了基础。他提出的"十二气历"历法改革建议，虽然当时未被采纳，但其科学性甚至超过了现行的公历。沈括在地质学方面提出的地貌形成自然侵蚀说，是中国古代地质学的重要理论，对理解地球表面形态变化具有重要意义。他在物理学方面对凹面镜成像原理的研究，对声学共振现象的实验，都比西方早几百年。沈括在医学方面对药物的研究，对中医理论的发展也有重要贡献。沈括的科学方法注重实验和观察，强调实证精神，这种科学态度对后世科学家产生了深远影响。他的全面性科学成就，体现了中国古代科学家的综合素养，为后世科学研究树立了榜样。《梦溪笔谈》作为中国古代科学的重要著作，不仅在中国科学史上占有重要地位，在世界科学史上也有重要影响，是了解中国古代科学成就的重要窗口。',
          modelPath: '/models/figures/shenkuo.glb'
        });
      } else if (figure.name === '苏颂') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '北宋科学家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '1020年-1101年',
          contribution: figure.contribution || '苏颂是北宋杰出的科学家、天文学家和政治家，设计制造了世界上最早的机械钟表——水运仪象台，著有《新仪象法要》等重要著作。水运仪象台是一座由水力驱动的天文钟，集天文观测、天象演示和计时报时功能于一体，代表了当时世界最高水平的天文技术。苏颂将浑仪、浑象、司辰三器组合成一个整体，这是中国古代天文机械制造史上的一大创造。他还在药物学方面有重要贡献，编撰了《本草图经》，系统记录了药物的产地、形态、功效等信息，配有精美插图，是中国古代重要的药物学著作。',
          achievements: [
            '水运仪象台：设计制造了世界上最早的机械钟表——水运仪象台，集天文观测、天象演示和计时报时功能于一体',
            '新仪象法要：撰写《新仪象法要》，详细记录了水运仪象台的设计原理和制造方法',
            '本草图经：编撰《本草图经》，系统记录药物知识，配有精美插图',
            '天文观测：改进天文观测仪器，提高观测精度',
            '外交贡献：出使辽国，解决了历法差异问题，促进了文化交流'
          ],
          biography: '苏颂（1020年-1101年），字子容，福建泉州南安人，北宋杰出的科学家、天文学家和政治家。苏颂出身于官宦家庭，从小接受了良好的教育以及天文历法的熏陶。据其孙苏象先在《魏公谭训》中记载，苏颂小时，曾祖母房中就有北极、北斗四圣像，家中还收藏有浑天仪的小样，这都成了他儿时的玩具。16岁时，苏颂父亲在扬州任通判，让他作《夏正建寅赋》，展现了他对天文历法的深厚理解。庆历二年（1042年）中进士，先任地方官，后改任馆阁校勘、集贤校理等职。宋哲宗时期，先后任刑部尚书、吏部尚书等职，晚年入阁拜相。苏颂入朝为官后，遍览皇家藏书，刻苦钻研天文历法知识，为以后制造天文仪器打下了基础。宋哲宗元祐元年（1086年）十一月，诏命苏颂制造新的浑天仪。苏颂立即召集天文历法官员，一面收集天文资料，一面开始寻访有天文专长的人才。他发现了精通《九章算术》、掌握"测天之术"的韩公廉，以及寿州州学教授王沇之等人，组建了一支专业团队。经过三年的精心研制，新的浑天仪终于造成，用铜约两万斤。因为它是由水力推动枢轮起动机器运转，所以称为"水运仪象台"。这座水运浑象台，高约12米，宽约7米，相当于现在一座四层高的住宅楼房。水运仪象台共三层：上层装有浑仪，中层设有浑象，下层是报时的五层木楼。水运仪象台不需要人力控制，其动力机械是一个由三十六个水斗和钩状铁拨构成的枢轮，即水轮。整座仪器既能观测天文星象，测出日月星辰的位置，又能用于计时报时。水运仪象台铸造竣工后，苏颂奉诏"记其制度"，将其设计原理、全部设计图样以及图样的文字说明汇集成书，撰写了《新仪象法要》一书。除了天文学成就外，苏颂还在药物学方面有重要贡献，编撰了《本草图经》，系统记录了药物的产地、形态、功效等信息，配有精美插图。晚年的苏颂，仍然对星空充满了热爱，他一边观看天空的星象，一边向子孙们讲解天文学的知识。宋徽宗建中靖国元年（1101年）五月，苏颂去世，享年81岁。',
          impact: '苏颂的科学成就对中国古代科学发展产生了深远影响，也在世界科技史上占有重要地位。他设计制造的水运仪象台是世界上最早的机械钟表，比欧洲早几百年，代表了当时世界最高水平的天文技术。英国著名科学家约瑟在研究了苏颂的水运仪象台后，给予极高评价，认为"苏颂把时钟机械和观察用浑仪结合起来，在原理上已经完全成功。因此可以说他比罗伯特·胡克先行了六个世纪，比方和斐先行了七个半世纪。"苏颂将浑仪、浑象、司辰三器组合成一个整体，这是水运仪象台的最大特色，也是中国古代天文机械制造史上的一大创造。水运仪象台的擒纵装置是世界上最早的擒纵器，为后世机械钟表的发展奠定了基础。苏颂撰写的《新仪象法要》是中国古代第一部最完整、代表宋代最高水平的天文机械及其图样的专著，为后世保存了宝贵的科技资料。在药物学方面，苏颂编撰的《本草图经》是中国古代重要的药物学著作，系统记录了药物的产地、形态、功效等信息，配有精美插图，对中医药学的发展产生了深远影响。苏颂的科学方法注重实践和创新，他组织团队协作，进行反复试验，最终取得了重大科技成就，这种科学态度和方法对后世科学家产生了深远影响。苏颂的全面性科学成就，体现了中国古代科学家的综合素养，为后世科学研究树立了榜样。',
          modelPath: '/models/figures/susong.glb'
        });
      } else if (figure.name === '郭守敬') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '元代天文学家、水利工程师',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '1231年-1316年',
          contribution: figure.contribution || '郭守敬是元代著名的天文学家和水利工程师，主持编制了精度极高的《授时历》，进行了大规模的天文观测活动。他发明了多种天文仪器，包括简仪、高表等，大大提高了天文观测的精度。郭守敬还负责多项水利工程，对元代科技发展做出了重要贡献。',
          achievements: [
            '授时历编制：主持编制《授时历》，采用365.2425天的回归年长度，与现代公历相同，精度极高',
            '天文仪器：发明和改进了简仪、高表等多种天文仪器，提高了观测精度',
            '天文观测：在全国范围内建立观测站，进行大规模天文观测',
            '水利工程：设计和修建了多项水利工程，解决了元大都的供水问题'
          ],
          biography: '郭守敬（1231年-1316年），字若思，号道隐，现河北邢台人。元代著名天文学家、数学家和水利工程师。郭守敬自幼聪颖好学，精通天文、数学和水利技术。元世祖忽必烈时期，他被任命为司天监正，负责历法改革和天文观测。郭守敬主持编制的《授时历》是中国古代最精确的历法之一，其回归年长度与现代公历完全相同。他还发明和改进了多种天文仪器，在全国范围内建立了观测站，进行了大规模的天文观测活动。除天文成就外，郭守敬还负责设计和修建了多项水利工程，解决了元大都的供水问题。他的科学成就对中国古代科技发展产生了深远影响。',
          impact: '郭守敬的天文成就代表了中国古代天文学的最高水平，《授时历》的精度在当时世界上首屈一指，直到明末西方天文学传入中国前一直沿用。他发明的天文仪器和观测方法大大提高了天文观测的精度，为后世天文研究奠定了基础。郭守敬的水利工程成就同样卓著，他设计的水利系统展现了高超的工程技术。为纪念他的贡献，月球上有一个环形山以及一颗小行星被命名为"郭守敬"。',
          modelPath: '/models/figures/guoshoujing.glb'
        });
      } else if (figure.name === '王朝辅') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '宋代天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '约11世纪',
          contribution: figure.contribution || '王朝辅是宋代著名天文学家，主要贡献是编制了《五星历》，对五大行星（金、木、水、火、土）的运行规律进行了精确计算和记录。他的研究对宋代天文学的发展产生了重要影响，为后世研究行星运动提供了宝贵资料。',
          achievements: [
            '五星历编制：编制了《五星历》，精确计算了金、木、水、火、土五大行星的运行规律',
            '行星运动研究：系统研究了五大行星的位置变化和周期性运动',
            '天文观测：进行了长期的天象观测，积累了大量行星运动数据',
            '历法改进：对宋代历法的完善做出了贡献'
          ],
          biography: '王朝辅生活于宋代，是当时著名的天文学家。关于他的生平资料较为有限，但从历史记载中可知，他在宋代天文机构中担任重要职务，负责天象观测和历法计算工作。王朝辅最重要的成就是编制了《五星历》，这是一部专门研究五大行星运动规律的天文著作。他通过长期观测和精确计算，记录了金、木、水、火、土五大行星的位置变化和周期性运动，为宋代天文学的发展做出了重要贡献。王朝辅的研究工作体现了宋代天文学的精确性和系统性，是中国古代行星研究的重要成果。',
          impact: '王朝辅编制的《五星历》是中国古代行星研究的重要成果，对后世天文学产生了深远影响。他对五大行星运动规律的精确计算，展示了宋代天文学的高度发展。王朝辅的研究方法和成果被后世天文学家继承和发展，成为中国古代天文学宝贵的科学遗产。他的工作为中国古代天文学在行星研究领域做出了独特贡献，丰富了中国古代天文学的内容。',
          modelPath: '/models/figures/wangchaofu.glb'
        });
      } else if (figure.name === '徐光启') {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: '明代科学家、天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          birthDeath: '1562年-1633年',
          contribution: figure.contribution || '徐光启是明代杰出的科学家、天文学家和政治家，是中西文化交流和中国近代科学技术事业的先驱之一。他与意大利传教士利玛窦合作翻译了《几何原本》前六卷，引入了西方数学和天文学知识。徐光启主持编纂了《崇祯历书》，系统介绍了西方古典天文学理论和方法，推动了中国天文历法的改革。他还编纂了《农政全书》，集中国古代农学之大成。徐光启的科学成就和文化贡献对中国近代科学发展产生了深远影响。',
          achievements: [
            '几何原本翻译：与利玛窦合作翻译《几何原本》前六卷，引入西方数学知识',
            '崇祯历书编纂：主持编纂《崇祯历书》，系统介绍西方天文学理论和方法',
            '历法改革：推动明朝历法改革，提高历法精度',
            '农政全书编纂：编纂《农政全书》，集中国古代农学之大成',
            '西学东渐：推动西方科学技术在中国的传播和应用'
          ],
          biography: '徐光启（1562年4月24日-1633年11月8日），字子先，号玄扈，明朝松江府上海县人。他出身于务农家庭，少年时代在龙华寺读书。万历九年（1581年）中秀才，万历二十五年（1597年）中举人，万历三十二年（1604年）中进士，入翰林院为庶吉士。万历三十四年（1606年）开始与利玛窦合作翻译《几何原本》前六卷，次年翻译完成并刊行，这是西方数学著作首次被系统地介绍到中国。徐光启还研究农业、水利、军事等多个领域，进行了各种农业实验，编写了多部著作。天启年间，因不满魏忠贤专权而辞官回乡，专心编纂《农政全书》。崇祯即位后，徐光启被召回朝廷，历任礼部右侍郎、左侍郎、尚书等职。崇祯二年（1629年），因钦天监推算日食失准，徐光启受命主持历法改革，开始编纂《崇祯历书》。崇祯六年（1633年），徐光启官至礼部尚书兼文渊阁大学士，同年十一月八日病逝于任上，谥号"文定"。',
          impact: '徐光启是中国科学史上的重要人物，他的贡献体现在多个方面。在天文学领域，他主持编纂的《崇祯历书》系统介绍了西方天文学理论和方法，推动了中国天文历法的改革，提高了历法精度。在数学领域，他与利玛窦合作翻译的《几何原本》引入了西方几何学知识，对中国数学发展产生了深远影响。徐光启还在农学、水利、军事等领域有重要贡献，编纂的《农政全书》集中国古代农学之大成，成为中国农学史上的重要著作。作为中西文化交流的先驱，徐光启提出了"会通"思想，主张吸收西方先进科学技术，促进中国科学发展，这一思想对后世产生了深远影响。徐光启的科学精神和实践态度，为中国近代科学发展开辟了道路。',
          modelPath: '/models/figures/xuguangqi.glb'
        });
      } else if (figure.name === '梅文鼎') {
        figures.push({
          id: 'ming-qing-梅文鼎',
          dynasty: '明清',
          dynastyId: 'ming-qing',
          name: '梅文鼎',
          title: '清代天文学家、数学家',
          birthDeath: '1633-1721',
          contribution: '梅文鼎是清初著名的天文学家、数学家和历算学家，被誉为"历算第一名家"。他系统考究古今中外历法，创造了多种天文仪器，著有《历学骈枝》等80余种著作，对中西方天文学和数学知识进行了融会贯通，为清代天文历法和数学发展做出了重大贡献。',
          achievements: [
            '创造了"揆日器"、"测望仪"、"仰观仪"、"月道仪"、"浑天新仪"等多种天文仪器',
            '著有《历学骈枝》、《平三角举要》、《弧三角举要》等重要天文数学著作',
            '系统考究古今中外历法，辨证元代授时历和明代大统历的差异',
            '将中西方数学知识进行融会贯通，推动了清代数学的发展',
            '主张"地圆说"，对天文观测和理论研究做出重要贡献'
          ],
          biography: '梅文鼎（1633年-1721年），字定九，号勿庵，安徽宣城人。早年随父亲梅士昌读《周易》，在父亲影响下喜爱观测天象。十五岁时补为博士弟子员，二十岁结婚后因祖父和父亲相继去世，为守孝与维持家计，未再参加科举考试。二十七岁时与弟弟师从道士倪正学习数学和历法。明末清初西方科学知识的传入对他产生了巨大影响。康熙四十一年（1702年），李光地向康熙帝推荐其著作《历学疑问》，康熙帝读后大为折服，次年南巡时特召至龙舟中长谈三天，并亲书"绩学参微"四个大字表彰他在天文、数学方面的深厚造诣。康熙帝还赐其长孙梅瑴成进士出身，入值南书房。梅文鼎一生博览群书，著述80余种，逝世后后人将其历法、数学著述汇为《梅氏丛书辑要》。',
          impact: '梅文鼎在天文、数学、历法等方面的造诣都很深。他的天文学著作有40多种，纠正了前人的许多错误，对当时和后世融会贯通中西方天文学具有很大作用。在数学方面，他论述多元一次方程、"求周径密率捷法"、"求弦矢捷法"等公式，写了20多种数学著作，将中西方的数学进行了融会贯通，对清朝数学的发展起了推动作用。在历法方面，他系统考究古今中外历法，辨证元代授时历和明代大统历的差异，校正其中的错误数据，详述重点难处，为后代学者研究历法提供了重要参考。他的学术成就对后世产生了深远影响，江永等人在天文学上继承了他的观点，承认"地圆说"的合理性。'
        });
      } else if (figure.name === '南怀仁') {
        figures.push({
          id: 'ming-qing-南怀仁',
          dynasty: '明清',
          dynastyId: 'ming-qing',
          name: '南怀仁',
          title: '比利时传教士、天文学家',
          birthDeath: '1623-1688',
          contribution: '南怀仁（Ferdinand Verbiest）是清康熙朝著名的比利时传教士、天文学家，担任钦天监监副，主持修建了北京古观象台，设计制造了多种精密天文仪器，编制了精确的历法，并将西方天文学和数学知识系统地引入中国。他还在机械、地理、语言等多个领域有重要贡献，是中西文化交流的重要使者。',
          achievements: [
            '主持修建北京古观象台，设计制造了六种精密天文仪器，包括地平经纬仪、象限仪、黄道经纬仪等',
            '编制精确的历法，纠正了当时历法中的错误，提高了历法精度',
            '著有《新制仪象图》《欧洲天文学》等重要科学著作',
            '设计了世界上最早的蒸汽动力车，被视为汽车的雏形',
            '绘制了《坤舆全图》，向中国介绍了世界地理知识'
          ],
          biography: '南怀仁（Ferdinand Verbiest，1623年10月9日-1688年1月28日），字敦伯，一字勋卿，比利时皮特姆人。1641年加入耶稣会，在鲁汶大学学习哲学和数学，后在塞维利亚学习神学并于1655年被任命为牧师。1658年随卫匡国前往中国，1659年抵达澳门。南怀仁最初在山西传教，1660年受召前往北京协助汤若望。1669年4月1日（康熙八年三月初一日），南怀仁接替汤若望被授以钦天监监副。他通过一系列天文测算的比试，证明了西方天文学的优越性，获得了康熙皇帝的信任。南怀仁精通多国语言，包括满语、拉丁语、德语、荷兰语、西班牙语、意大利语和鞑靼语，他为康熙皇帝讲授几何学，翻译了欧几里得《几何原本》前六卷为满文。1673年，他主持重建北京古观象台，设计制造了六种精密天文仪器，这些仪器至今仍保存完好。1688年1月28日（康熙二十七年），南怀仁逝世于北京，康熙追赠工部右侍郎，谥为"勤敏"，与利玛窦、汤若望埋在同一个墓园。',
          impact: '南怀仁在天文学、数学、地理学、机械学等多个领域对中国科学发展产生了深远影响。他设计的天文仪器代表了当时世界最先进的水平，使中国天文观测技术得到了显著提高。他编制的历法纠正了传统历法中的错误，提高了历法精度，为农业生产和社会生活提供了更准确的时间参考。南怀仁还将西方的几何学、天文学等知识系统地引入中国，促进了中西方科学文化的交流。他设计的蒸汽动力车被视为汽车的雏形，展示了西方机械技术的先进性。作为中西文化交流的重要使者，南怀仁不仅传播了西方科学技术，也向西方介绍了中国文化，为中西文化交流做出了重要贡献。康熙皇帝对他的信任和重用，也为后来更多西方传教士和学者进入中国创造了有利条件，推动了中西文化的深入交流。'
        });
      } else if (figure.name === '戴进贤') {
        figures.push({
          id: 'ming-qing-戴进贤',
          dynasty: '明清',
          dynastyId: 'ming-qing',
          name: '戴进贤',
          title: '德国传教士、天文学家',
          birthDeath: '1680-1746',
          contribution: '戴进贤（Ignaz Kögler）是清康熙、雍正、乾隆三朝著名的德国耶稣会传教士、天文学家和数学家，担任钦天监监正长达21年。他主持编纂了《御制历象考成后编》，引入了牛顿月亮理论和开普勒定律，大幅提高了清朝历法的精度。他还主持设计制造了璣衡撫辰儀，开展了周天恒星的系统测量，完成了《欽定儀象考成》的编纂，并创作了中国历史上最早的铜版星图《黄道总星图》。',
          achievements: [
            '主持编纂《御制历象考成后编》，引入牛顿月亮理论和开普勒定律，提高历法精度',
            '主持设计制造璣衡撫辰儀，开展周天恒星的系统测量',
            '完成《欽定儀象考成》的编纂，对恒星位置进行精确测量',
            '创作中国历史上最早的铜版星图《黄道总星图》',
            '著有《策算》等数学著作，介绍对数及其用法'
          ],
          biography: '戴进贤（Ignaz Kögler，1680年5月11日-1746年3月30日），字嘉宾，德国巴伐利亚兰茨贝格人。1696年加入耶稣会，在耶稣会学校学习拉丁文、哲学、数学、物理等，获得文艺硕士学位。1706-1709年在英戈尔施塔特大学深造，学习哲学、神学、数学及东方语言，1709年被任命为教士。1712年开始担任英戈尔施塔特大学数学和东方语言教授。1716年（康熙五十五年）从里斯本启航，同年抵达澳门。戴进贤凭借天文学特长获得康熙皇帝的信任，1717年（康熙56年）奉命到钦天监任职；1725年（雍正3年）被授以"监正"之职，任职钦天监长达29年，直到逝世。期间在1731年（雍正九年）被授予礼部侍郎二品衔。戴进贤通过系统日月食观测检验历法精度，发现德国耶稣会天文学家格拉马迪奇根据牛顿月亮理论编纂的日月运动表精度最高。他与葡萄牙耶稣会士徐懋德合作，在格拉马迪奇日月运动表的基础上，编成《御制历象考成表》，后完成《御制历象考成后编》的编纂，在太阳和月亮运动分析和计算中采用了牛顿的月亮理论、开普勒的椭圆轨道定律和等面积定律，使清朝钦天监在日月运动和日月食计算方面的精度大幅度提高。1744年（乾隆9年），他与奥地利耶稣会士刘松龄主持设计铸造了璣衡撫辰儀，开展周天恒星的系统测量，完成《欽定儀象考成》的编纂。戴进贤还与意大利画家和雕刻家利白明合作完成了《黄道总星图》，这是中国历史上最早的铜版星图。戴进贤于1746年3月30日卒于北京，享年66岁，被安葬在藤公栅栏墓地。',
          impact: '戴进贤在天文学、数学和历法等多个领域对中国科学发展产生了深远影响。他引入的牛顿月亮理论和开普勒定律大幅提高了清朝历法的精度，根据《历象考成后编》编制的时宪历（癸卯元历），一直被使用到民国二年。他主持编纂的《欽定儀象考成》记录了3083颗恒星的精确位置，为中国天文观测提供了重要参考。他创作的《黄道总星图》是中国历史上最早的铜版星图，在中西科技交流中发挥了重要作用。戴进贤还与欧洲多国科学院的科学家保持联系，他的观测成果常被欧洲天文学家引用，促进了中西方科学交流。作为一位杰出的天文学家和数学家，戴进贤不仅将西方先进的天文学知识引入中国，也将中国的天文观测成果传播到欧洲，在中西科学文化交流史上留下了重要的一页。'
        });
      } else {
        figures.push({
          id: `${dynasty.id}-${figure.name}`.toLowerCase().replace(/\s+/g, '-'),
          name: figure.name,
          title: figure.title || '天文学家',
          dynasty: dynasty.name,
          dynastyId: dynasty.id,
          contribution: figure.contribution,
          achievements: [],
          biography: '暂无详细生平信息',
          impact: '对中国古代天文学的发展做出了重要贡献',
          modelPath: '/models/default-figure.glb'
        });
      }
    });
  });
  
  return figures;
};

// 获取人物对应的3D模型路径
const getFigureModelPath = (figureId: string): string => {
  // 为每个历史人物提供专属的3D模型路径
  const modelPaths: Record<string, string> = {
    'xia-shang-zhou-后羿': '/models/figures/houyi.glb',
    'xia-shang-zhou-仪狄': '/models/figures/yidi.glb',
    'xia-shang-zhou-周公': '/models/figures/zhougong.glb',
    'spring-autumn-甘德': '/models/figures/gande.glb',
    'spring-autumn-石申': '/models/figures/shishen.glb',
    'spring-autumn-邹衍': '/models/figures/zouyan.glb',
    'qin-han-张衡': '/models/figures/zhangheng.glb',
    'qin-han-落下闳': '/models/figures/luoxiahong.glb',
    'qin-han-刘向': '/models/figures/liuxiang.glb',
    'qin-han-刘歆': '/models/figures/liuxin.glb',
    'wei-jin-祖冲之': '/models/figures/zuchongzhi.glb',
    'wei-jin-何承天': '/models/figures/hechentian.glb',
    'wei-jin-虞喜': '/models/figures/yuxi.glb',
    'sui-tang-一行': '/models/figures/yixing.glb',
    'sui-tang-南宫说': '/models/figures/nangongshuo.glb', 
    'sui-tang-李淳风': '/models/figures/lichunfeng.glb',
    'sui-tang-袁天罡': '/models/figures/yuantiangang.glb',
    'song-yuan-沈括': '/models/figures/shenkuo.glb',
    'song-yuan-苏颂': '/models/figures/susong.glb',
    'song-yuan-郭守敬': '/models/figures/guoshoujing.glb',
    'song-yuan-王朝辅': '/models/figures/wangchaofu.glb',
    'ming-qing-徐光启': '/models/figures/xuguangqi.glb',
    'ming-qing-梅文鼎': '/models/figures/meiwending.glb',
    'ming-qing-南怀仁': '/models/figures/nanhuairen.glb',
    'ming-qing-戴进贤': '/models/figures/daijinxian.glb'
  };
  
  return modelPaths[figureId] || '/models/figures/default.glb';
};

const FigurePage = () => {
  const router = useRouter();
  const { id } = router.query;
  const [figure, setFigure] = useState<HistoricalFigure | null>(null);
  const [loading, setLoading] = useState(true);
  const modelContainerRef = useRef<HTMLDivElement>(null);
  const [modelLoaded, setModelLoaded] = useState(false);
  const [modelError, setModelError] = useState(false);
  const [renderer, setRenderer] = useState<THREE.WebGLRenderer | null>(null);
  const [scene] = useState(new THREE.Scene());
  const [camera] = useState(new THREE.PerspectiveCamera(45, 1, 0.1, 1000));
  const [controls, setControls] = useState<OrbitControls | null>(null);
  const animationFrameRef = useRef<number>(0);

  useEffect(() => {
    if (!id) return;

    const figures = getAllHistoricalFigures();
    const foundFigure = figures.find(f => f.id === id);
    
    if (foundFigure) {
      setFigure(foundFigure);
      setLoading(false);
    } else {
      setLoading(false);
    }
  }, [id]);

  // 初始化3D场景
  useEffect(() => {
    if (!figure || !modelContainerRef.current) return;

    // 清理之前的渲染器
    if (renderer) {
      try {
        if (modelContainerRef.current.contains(renderer.domElement)) {
          modelContainerRef.current.removeChild(renderer.domElement);
        }
        renderer.dispose();
      } catch (error) {
        console.error("Error cleaning up previous renderer:", error);
      }
    }

    // 创建新的渲染器
    const newRenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    const container = modelContainerRef.current;
    const width = container.clientWidth;
    const height = container.clientHeight;
    
    newRenderer.setSize(width, height);
    newRenderer.setPixelRatio(window.devicePixelRatio);
    newRenderer.setClearColor(0x000000, 0);
    newRenderer.shadowMap.enabled = true;
    container.appendChild(newRenderer.domElement);
    setRenderer(newRenderer);

    // 设置场景
    scene.clear();
    scene.background = new THREE.Color(0x111827);
    
    // 添加环境光和方向光
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
    directionalLight.position.set(5, 5, 5);
    directionalLight.castShadow = true;
    scene.add(directionalLight);

    const backLight = new THREE.DirectionalLight(0xffd700, 0.5);
    backLight.position.set(-5, 5, -5);
    scene.add(backLight);
    
    // 设置相机
    camera.aspect = width / height;
    camera.position.set(0, 1.5, 4);
    camera.lookAt(0, 1, 0);
    camera.updateProjectionMatrix();
    
    // 添加控制器
    const newControls = new OrbitControls(camera, newRenderer.domElement);
    newControls.enableDamping = true;
    newControls.dampingFactor = 0.05;
    newControls.minDistance = 2;
    newControls.maxDistance = 10;
    newControls.maxPolarAngle = Math.PI / 1.5;
    setControls(newControls);

    // 添加星空背景
    const starGeometry = new THREE.BufferGeometry();
    const starMaterial = new THREE.PointsMaterial({
      color: 0xffffff,
      size: 0.02,
    });

    const starVertices = [];
    for (let i = 0; i < 1000; i++) {
      const x = (Math.random() - 0.5) * 100;
      const y = (Math.random() - 0.5) * 100;
      const z = (Math.random() - 0.5) * 100;
      starVertices.push(x, y, z);
    }

    starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
    const stars = new THREE.Points(starGeometry, starMaterial);
    scene.add(stars);

    // 添加地面
    const groundGeometry = new THREE.CircleGeometry(2, 32);
    const groundMaterial = new THREE.MeshStandardMaterial({ 
      color: 0x3f3f3f,
      roughness: 0.8,
      metalness: 0.2,
    });
    const ground = new THREE.Mesh(groundGeometry, groundMaterial);
    ground.rotation.x = -Math.PI / 2;
    ground.position.y = -0.01;
    ground.receiveShadow = true;
    scene.add(ground);

    // 添加装饰性光环
    const ringGeometry = new THREE.RingGeometry(1.9, 2, 32);
    const ringMaterial = new THREE.MeshBasicMaterial({ 
      color: 0xd4af37,
      side: THREE.DoubleSide,
      transparent: true,
      opacity: 0.3
    });
    const ring = new THREE.Mesh(ringGeometry, ringMaterial);
    ring.rotation.x = -Math.PI / 2;
    ring.position.y = 0;
    scene.add(ring);

    // 创建一个更精美的占位模型（在加载真实模型失败时使用）
    const createPlaceholderModel = () => {
      // 创建一个组合模型
      const group = new THREE.Group();
      
      // 创建底座
      const baseGeometry = new THREE.CylinderGeometry(0.7, 0.8, 0.2, 32);
      const baseMaterial = new THREE.MeshStandardMaterial({
        color: 0x3a3a3a,
        metalness: 0.7,
        roughness: 0.3
      });
      const base = new THREE.Mesh(baseGeometry, baseMaterial);
      base.position.y = -0.1;
      base.castShadow = true;
      base.receiveShadow = true;
      group.add(base);
      
      // 创建主体部分
      const bodyGeometry = new THREE.CylinderGeometry(0.4, 0.6, 1.8, 32);
      const bodyMaterial = new THREE.MeshStandardMaterial({
        color: 0xd4af37,
        metalness: 0.5,
        roughness: 0.5,
        transparent: true,
        opacity: 0.7
      });
      const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
      body.position.y = 0.9;
      body.castShadow = true;
      group.add(body);
      
      // 创建头部
      const headGeometry = new THREE.SphereGeometry(0.4, 32, 32);
      const headMaterial = new THREE.MeshStandardMaterial({
        color: 0xd4af37,
        metalness: 0.3,
        roughness: 0.7
      });
      const head = new THREE.Mesh(headGeometry, headMaterial);
      head.position.y = 2.0;
      head.castShadow = true;
      group.add(head);
      
      // 添加装饰性元素
      const decorGeometry = new THREE.TorusGeometry(0.5, 0.05, 16, 100);
      const decorMaterial = new THREE.MeshStandardMaterial({
        color: 0xffffff,
        emissive: 0xd4af37,
        emissiveIntensity: 0.5,
        metalness: 1.0,
        roughness: 0.3
      });
      const decor = new THREE.Mesh(decorGeometry, decorMaterial);
      decor.position.y = 1.5;
      decor.rotation.x = Math.PI / 2;
      decor.castShadow = true;
      group.add(decor);
      
      return group;
    };
    
    // 添加人物名字的文字显示
    const createNameDisplay = (name: string) => {
      const canvas = document.createElement('canvas');
      canvas.width = 512;
      canvas.height = 256;
      const context = canvas.getContext('2d');
      if (context) {
        context.fillStyle = '#000000';
        context.fillRect(0, 0, 512, 256);
        
        // 绘制背景渐变
        const gradient = context.createLinearGradient(0, 0, 0, 256);
        gradient.addColorStop(0, 'rgba(0, 0, 0, 0.8)');
        gradient.addColorStop(1, 'rgba(0, 0, 0, 0.4)');
        context.fillStyle = gradient;
        context.fillRect(0, 0, 512, 256);
        
        // 绘制边框
        context.strokeStyle = '#d4af37';
        context.lineWidth = 8;
        context.strokeRect(10, 10, 492, 236);
        
        // 绘制文字
        context.font = 'Bold 120px "Microsoft YaHei", "微软雅黑", Arial';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        
        // 绘制文字阴影
        context.fillStyle = 'rgba(0, 0, 0, 0.7)';
        context.fillText(name.charAt(0), 258, 128);
        
        // 绘制文字
        context.fillStyle = '#d4af37';
        context.fillText(name.charAt(0), 256, 126);
        
        // 绘制人物全名
        context.font = '32px "Microsoft YaHei", "微软雅黑", Arial';
        context.fillStyle = '#ffffff';
        context.fillText(name, 256, 210);
      }
      
      const texture = new THREE.CanvasTexture(canvas);
      const geometry = new THREE.PlaneGeometry(2, 1);
      const material = new THREE.MeshBasicMaterial({
        map: texture,
        transparent: true,
        opacity: 0.95,
        side: THREE.DoubleSide
      });
      
      const mesh = new THREE.Mesh(geometry, material);
      mesh.position.set(0, 1.2, 0);
      mesh.rotation.y = Math.PI / 2;
      
      return mesh;
    };

    // 创建临时占位模型和名字显示
    const placeholderModel = createPlaceholderModel();
    placeholderModel.position.y = 0;
    placeholderModel.visible = false; // 初始隐藏，只在加载失败时显示
    scene.add(placeholderModel);
    
    const nameDisplay = createNameDisplay(figure.name);
    nameDisplay.visible = false; // 初始隐藏，只在加载失败时显示
    scene.add(nameDisplay);
    
    // 设置加载状态
    setModelLoaded(false);
    setModelError(false);
    
    // 加载真实3D模型
    const modelPath = getFigureModelPath(figure.id as string);
    const loader = new GLTFLoader();
    
    try {
      loader.load(
        modelPath,
        (gltf) => {
          const model = gltf.scene;
          
          // 调整模型大小和位置
          const box = new THREE.Box3().setFromObject(model);
          const size = box.getSize(new THREE.Vector3());
          const center = box.getCenter(new THREE.Vector3());
          
          const scale = 2 / Math.max(size.x, size.y, size.z);
          model.scale.set(scale, scale, scale);
          
          model.position.x = -center.x * scale;
          model.position.y = -center.y * scale;
          model.position.z = -center.z * scale;
          
          // 确保模型位于地面上
          const newBox = new THREE.Box3().setFromObject(model);
          model.position.y = -newBox.min.y;
          
          // 添加阴影
          model.traverse((node) => {
            if (node instanceof THREE.Mesh) {
              node.castShadow = true;
              node.receiveShadow = true;
            }
          });
          
          scene.add(model);
          setModelLoaded(true);
        },
        (xhr) => {
          // 加载进度
          console.log((xhr.loaded / xhr.total * 100) + '% loaded');
        },
        (error) => {
          // 加载错误，显示占位模型
          console.error('An error happened while loading the model:', error);
          placeholderModel.visible = true;
          nameDisplay.visible = true;
          setModelLoaded(true);
          setModelError(true);
        }
      );
    } catch (error) {
      // 加载异常，显示占位模型
      console.error('Failed to load model:', error);
      placeholderModel.visible = true;
      nameDisplay.visible = true;
      setModelLoaded(true);
      setModelError(true);
    }
    
    // 动画循环
    const animate = () => {
      animationFrameRef.current = requestAnimationFrame(animate);
      
      if (controls) {
        controls.update();
      }
      
      // 旋转星空
      stars.rotation.y += 0.0001;
      
      // 旋转光环
      ring.rotation.z += 0.001;
      
      // 如果显示占位模型，则添加动画效果
      if (modelError) {
        // 旋转装饰元素
        if (placeholderModel.children.length > 3) {
          placeholderModel.children[3].rotation.y += 0.01;
        }
        
        // 旋转名字显示
        nameDisplay.rotation.y += 0.005;
      }
      
      newRenderer.render(scene, camera);
    };
    
    animate();
    
    // 处理窗口大小变化
    const handleResize = () => {
      if (!container) return;
      
      const width = container.clientWidth;
      const height = container.clientHeight;
      
      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      
      newRenderer.setSize(width, height);
    };
    
    window.addEventListener('resize', handleResize);
    
    // 清理函数
    return () => {
      window.removeEventListener('resize', handleResize);
      cancelAnimationFrame(animationFrameRef.current);
      
      if (newControls) {
        newControls.dispose();
      }
      
      if (newRenderer) {
        try {
          if (container && container.contains(newRenderer.domElement)) {
            container.removeChild(newRenderer.domElement);
          }
          newRenderer.dispose();
        } catch (error) {
          console.error("Error during cleanup:", error);
        }
      }
    };
  }, [figure, modelContainerRef.current]);

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-ancient-paper">
        <div className="text-center">
          <div className="w-16 h-16 border-4 border-ancient-gold border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-lg">正在加载人物信息...</p>
        </div>
      </div>
    );
  }

  if (!figure) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-ancient-paper">
        <div className="text-center max-w-md mx-auto p-8 bg-white rounded-lg shadow-lg">
          <h1 className="text-2xl font-bold text-red-700 mb-4">未找到人物信息</h1>
          <p className="mb-6">抱歉，我们无法找到您请求的历史人物信息。可能是链接错误或该人物数据尚未添加。</p>
          <Link href="/timeline" className="bg-ancient-gold text-white px-6 py-2 rounded-lg hover:bg-opacity-90 transition-all">
            返回时间线
          </Link>
        </div>
      </div>
    );
  }

  return (
    <>
      <Head>
        <title>{figure.name} - 中国古代天文学家 - 中国古代天文可视化</title>
        <meta name="description" content={`了解${figure.name}的生平、贡献和成就，${figure.dynasty}时期著名的${figure.title}`} />
      </Head>

      <Header />

      <main className="bg-ancient-paper min-h-screen pt-20">
        {/* 人物标题部分 */}
        <section className="relative py-16 bg-gradient-to-b from-ancient-dark to-ancient-paper overflow-hidden">
          <div className="absolute inset-0 opacity-20">
            <div className="stars-bg"></div>
          </div>
          
          <div className="container mx-auto px-4 relative z-10">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.8 }}
              className="text-center"
            >
              <Link 
                href={`/dynasty/${figure.dynastyId}`}
                className="inline-block text-ancient-gold mb-2 hover:underline"
              >
                {figure.dynasty}时期
              </Link>
              <h1 className="ancient-title text-ancient-ink text-4xl md:text-5xl mb-4">{figure.name}</h1>
              <p className="text-ancient-gold text-xl mb-6">{figure.title}</p>
              {figure.birthDeath && (
                <p className="text-gray-600 mb-4">{figure.birthDeath}</p>
              )}
            </motion.div>
          </div>
        </section>

        <div className="container mx-auto px-4 py-12">
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
            {/* 左侧：3D模型展示 */}
            <motion.div
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.8 }}
              className="bg-gradient-to-b from-ancient-dark to-black rounded-xl overflow-hidden shadow-xl"
            >
              <div 
                ref={modelContainerRef}
                className="relative aspect-square w-full"
              >
                {!modelLoaded && (
                  <div className="absolute inset-0 flex items-center justify-center z-10 pointer-events-none">
                    <div className="text-center text-white">
                      <div className="w-16 h-16 border-4 border-ancient-gold border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                      <p>正在加载3D模型...</p>
                    </div>
                  </div>
                )}
                
                {modelError && modelLoaded && (
                  <div className="absolute top-4 right-4 bg-black bg-opacity-70 text-white text-xs px-3 py-1 rounded-full z-10 pointer-events-none">
                    使用占位模型显示
                  </div>
                )}
                
                {/* 装饰元素 */}
                <div className="absolute top-4 left-4 w-20 h-20 border border-ancient-gold opacity-30 rounded-full pointer-events-none"></div>
                <div className="absolute bottom-8 right-8 w-32 h-32 border border-ancient-gold opacity-20 rounded-full pointer-events-none"></div>
                <div className="absolute top-1/4 right-1/4 w-2 h-2 bg-ancient-gold rounded-full animate-pulse pointer-events-none"></div>
                <div className="absolute bottom-1/3 left-1/3 w-3 h-3 bg-ancient-gold rounded-full animate-pulse animation-delay-500 pointer-events-none"></div>
              </div>
              
              <div className="p-6 text-center text-white">
                <p className="text-sm opacity-70">
                  提示：您可以拖动查看不同角度，使用滚轮进行缩放
                </p>
              </div>
            </motion.div>
            
            {/* 右侧：详细介绍 */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ duration: 0.8, delay: 0.2 }}
            >
              <div className="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h2 className="text-2xl font-bold text-ancient-ink mb-6 border-b border-gray-200 pb-3">主要贡献</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">{figure.contribution}</p>
                
                <h3 className="text-xl font-bold text-ancient-ink mb-4">生平简介</h3>
                <p className="text-gray-700 mb-6 leading-relaxed">{figure.biography}</p>
                
                <h3 className="text-xl font-bold text-ancient-ink mb-4">历史影响</h3>
                <p className="text-gray-700 leading-relaxed">{figure.impact}</p>
              </div>
              
              <div className="bg-white rounded-xl shadow-lg p-8">
                <h2 className="text-2xl font-bold text-ancient-ink mb-6 border-b border-gray-200 pb-3">历史背景</h2>
                <p className="text-gray-700 mb-6 leading-relaxed">
                  {figure.name}生活在{figure.dynasty}时期，这一时期的中国天文学{figure.dynasty === '魏晋南北朝' ? '经历了重要的发展阶段' : '取得了显著的成就'}。
                  {figure.dynasty === '汉代' && '汉代天文学继承了先秦时期的成果，并有了长足的发展。'}
                  {figure.dynasty === '宋元' && '宋元时期是中国古代天文学的高峰期之一，天文观测和历法制定都达到了很高的水平。'}
                </p>
                
                <Link 
                  href={`/dynasty/${figure.dynastyId}`}
                  className="inline-block bg-ancient-gold text-white px-6 py-2 rounded-lg hover:bg-opacity-90 transition-all"
                >
                  了解{figure.dynasty}天文成就
                </Link>
              </div>
            </motion.div>
          </div>
        </div>
      </main>

      <Footer />
    </>
  );
};

export default FigurePage; 